---
title: Deep Blue
date: 2023-09-09 22:47:30 +0300
categories: [BTLO,Deep Blue]
tags: [powershell,investigation,deepbluecli, event viewer]
---

# Deep Blue
Hello. Welcome to my blog. Today I will take you through the Deep Blue challenge found at https://blueteamlabs.online/home/investigation/deep-blue-a4c18ce507 (username is: btlo and no password)

The given scenario is: _'A Windows workstation was recently compromised, and evidence suggests it was an attack against internet-facing RDP, then Meterpreter was deployed to conduct 'Actions on Objectives'. Can you verify these findings?'_

To work through this, we will use the DeepBlueCLI - a powershell module for Threat Hunting in Windows event log - and Windows event viewer - a builtin tool in the Windows OS for viewing and analyzing event logs.



_Q1_ _Using DeepBlueCLI, investigate the recovered Security log (Security.evtx). Which user account ran GoogleUpdate.exe? (4 points)_

Here, the first step is to launch WIndows powershell and navigate into the directory containing the resources

The syntax for opening the log file in DeepBlueCLI is: 
```powershell
.\DeepBlue.ps1 .\evtx\new-user-security.evtx
```

_Q2_ _Using DeepBlueCLI investigate the recovered Security.evtx log. At what time is there likely evidence of Meterpreter activity? (4 points)_

_Q3_ _Using DeepBlueCLI investigate the recovered System.evtx log. What is the name of the suspicious service created? (5 points)_

_Q4_ _Investigate the Security.evtx log in Event Viewer. Process creation is being audited (event ID 4688). Identify the malicious executable downloaded that was used to gain a Meterpreter reverse shell, between 10:30 and 10:50 AM on the 10th of April 2021. (4 points)_

_Q5_ _It's also believed that an additional account was created to ensure persistence between 11:25 AM and 11:40 AM on the 10th April 2021. What was the command line used to create this account? (Make sure you've found the right account!) (4 points)_

_Q6_ _What two local groups was this new account added to? (4 points)_

